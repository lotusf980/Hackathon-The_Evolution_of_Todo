# Data Model: Phase 2 - Todo Full-Stack Web Application

## User Entity

### Attributes
- **id**: String (Primary identifier, unique)
  - Generated by Better Auth
  - Unique across all users
  - Immutable after creation

- **email**: String (Required, unique, valid email format)
  - User's email address for login
  - Required field during registration
  - Must be unique across all users

- **name**: String (Required, 1-100 characters)
  - User's display name
  - Required field during registration
  - May be updated by user

- **password**: String (Required, hashed)
  - Securely hashed user password
  - Required during registration
  - Stored securely using industry-standard hashing

- **created_at**: DateTime (Auto-generated)
  - Timestamp of when the user account was created
  - Automatically set when user is registered
  - Immutable after creation

### Relationships
- **Tasks**: One-to-many relationship with Task entity (one user to many tasks)

### Validation Rules
- Email must be valid email format
- Email must be unique across all users
- Name must be 1-100 characters
- Password must meet security requirements (handled by Better Auth)

## Task Entity

### Attributes
- **id**: Integer (Primary identifier, auto-incremented)
  - Generated when task is created
  - Unique within the entire database
  - Immutable after creation

- **user_id**: String (Foreign key to User, required)
  - Links the task to the owning user
  - Required field during creation
  - References the User.id field

- **title**: String (Required, 1-200 characters)
  - Title of the task
  - Required field during creation
  - Validated for length constraints

- **description**: String (Optional, 0-1000 characters)
  - Detailed information about the task
  - Optional field during creation/update
  - May be empty or null

- **completed**: Boolean (Default: False)
  - Indicates completion status of the task
  - False by default when created
  - Toggled between True/False via completion operations

- **created_at**: DateTime (Auto-generated)
  - Timestamp of when the task was created
  - Automatically set when task is instantiated
  - Immutable after creation

- **updated_at**: DateTime (Auto-generated and updated)
  - Timestamp of when the task was last updated
  - Automatically set when task is created
  - Updated automatically on each modification

### Relationships
- **User**: Many-to-one relationship with User entity (many tasks to one user)

### Validation Rules
- Title must be 1-200 characters (inclusive)
- Description must be 0-1000 characters (inclusive)
- User_id must reference an existing user
- User can only access tasks associated with their user_id
- Completion status must be boolean (True/False)

### State Transitions
- **Creation**: New task with completed=False, auto-generated ID and timestamps
- **Update**: Modify title and/or description while preserving user_id and creation timestamp
- **Toggle Completion**: Switch completed status between True and False
- **Deletion**: Remove task from database (requires user authentication and authorization)

## Database Schema

```sql
-- Users table (managed by Better Auth)
CREATE TABLE users (
    id TEXT PRIMARY KEY,
    email TEXT UNIQUE NOT NULL,
    name TEXT NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- Tasks table
CREATE TABLE tasks (
    id SERIAL PRIMARY KEY,
    user_id TEXT NOT NULL REFERENCES users(id),
    title VARCHAR(200) NOT NULL,
    description TEXT,
    completed BOOLEAN DEFAULT FALSE,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- Indexes for performance
CREATE INDEX idx_tasks_user_id ON tasks(user_id);
CREATE INDEX idx_tasks_completed ON tasks(completed);
```

## API Data Transfer Objects (DTOs)

### User Registration DTO
```typescript
interface UserRegistration {
  email: string;
  name: string;
  password: string;
}
```

### User Login DTO
```typescript
interface UserLogin {
  email: string;
  password: string;
}
```

### Task Creation DTO
```typescript
interface TaskCreation {
  title: string;
  description?: string;
}
```

### Task Update DTO
```typescript
interface TaskUpdate {
  title?: string;
  description?: string;
}
```

### Task Response DTO
```typescript
interface TaskResponse {
  id: number;
  user_id: string;
  title: string;
  description: string;
  completed: boolean;
  created_at: string;
  updated_at: string;
}
```